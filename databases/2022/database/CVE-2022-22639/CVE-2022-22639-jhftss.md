# CVE-2022-22639

CVE-2022-22639: Get a Root Shell on macOS Monterey

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/jhftss](https://github.com/jhftss) |
| Url      | [https://github.com/jhftss/CVE-2022-22639](https://github.com/jhftss/CVE-2022-22639)                                               |
| Stars    | 121                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# Details 
See Blog:

https://www.trendmicro.com/en_us/research/22/d/macos-suhelper-root-privilege-escalation-vulnerability-a-deep-di.html

# Exploitation of CVE-2022-22639
1. Compile with command:
`clang exploit.m -o /tmp/exploit -framework Foundation -fobjc-arc -fobjc-link-runtime /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/System/Library/PrivateFrameworks/SoftwareUpdate.framework/Versions/A/SoftwareUpdate.tbd`
2. Unzip **InstallAssistant.gz** to `/tmp` folder
3. run `/tmp/exploit`

# Demo
https://www.youtube.com/watch?v=-vbkTLHh874



## Get the content

```
git clone https://github.com/jhftss/CVE-2022-22639
cd CVE-2022-22639
```

{% embed url="https://github.com/jhftss/CVE-2022-22639" %}

<figure><img src="https://avatars.githubusercontent.com/u/10210124?v=4" alt=""><figcaption><p>jhftss</p></figcaption></figure>
