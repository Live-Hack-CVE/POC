# find-spooky-prismacloud

Find SpookySSL in Prisma Cloud Compute scans

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/hi-artem](https://github.com/hi-artem) |
| Url      | [https://github.com/hi-artem/find-spooky-prismacloud](https://github.com/hi-artem/find-spooky-prismacloud)                                               |
| Stars    | 2                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>

* cve-2022-3602* cve-2022-3786* openssl* prismacloud* scanner* security* spookyssl

</details>

## Readme

# find-spookyssl-prismacloudcompute

## Why do you need this?

OpenSSL has announced [a major bug affecting 3.x version](https://mta.openssl.org/pipermail/openssl-announce/2022-October/000238.html), known as SpookySSL. Lookup CVE-2022-3786 and CVE-2022-3602 for further details.

Unfortunately for Palo Alto Networks Prisma Cloud Compute users, this tool doesn't have a way to search all images by a package name. 

This script will search all your deployed containers, and dump them in a single json.

The script is targeting affected version of `openssl`, and binaries known to be compiled with vulnerable `openssl` version, like nodejs. See [this document](https://github.com/NCSC-NL/OpenSSL-2022/tree/main/software) for more information on affected software.

## How to run this?

You need `nodejs`, and `npm` or `yarn`. 

First, install dependencies by running `npm/yarn install`.

Second, export some of the important env variables:

```sh
export BASIC_AUTH_TOKEN=<YOUR-TOKEN-GOES-HERE>
export BASE_URL='https://prismacloudconsole.example.com/'
```

Finally, run the script:

```sh
node index.js
```

The report should contain affected containers as list of JSON objects.



## Get the content

```
git clone https://github.com/hi-artem/find-spooky-prismacloud
cd find-spooky-prismacloud
```

{% embed url="https://github.com/hi-artem/find-spooky-prismacloud" %}

<figure><img src="https://avatars.githubusercontent.com/u/67011886?v=4" alt=""><figcaption><p>hi-artem</p></figcaption></figure>
