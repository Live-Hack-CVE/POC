# Invoke-CVE-2022-22965-SafeCheck

PowerShell port of CVE-2022-22965 vulnerability check by colincowie.

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/daniel0x00](https://github.com/daniel0x00) |
| Url      | [https://github.com/daniel0x00/Invoke-CVE-2022-22965-SafeCheck](https://github.com/daniel0x00/Invoke-CVE-2022-22965-SafeCheck)                                               |
| Stars    | 1                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>

* cve-2022-22965* powershell* vulnerability-detection

</details>

## Readme

# Invoke-CVE-2022-22965-SafeCheck
PowerShell port of [CVE-2022-22965 by colincowie's original python version](https://github.com/colincowie/Safer_PoC_CVE-2022-22965).

## Install:
```
iex((iwr https://raw.githubusercontent.com/daniel0x00/Invoke-CVE-2022-22965-SafeCheck/main/Invoke-CVE202222965-SafeCheck.ps1 -UseBasicParsing).content)
```

## Usage:

```
# Injects file 'CVE_2022_22965_exploited.txt' on the server:
$Output = Get-Content targets.txt | ForEach-Object { Invoke-CVE202222965-SafeCheck -Url "https://$_" }

# Outputs vulnerable items only:
$Output | Where-Object {$_.url_content -match 'CVE_2022_22965 was sucessfully exploited' -or $_.base_content -match 'CVE_2022_22965 was sucessfully exploited'}
```

### With parallelism:

NOTE: Requires you place the script locally on `C:\scripts\Invoke-CVE-2022-22965-SafeCheck.ps1` or elsewhere.

```
$Output = Get-Content targets.txt | ForEach-Object -ThrottleLimit 4 -Parallel { . C:\scripts\Invoke-CVE-2022-22965-SafeCheck.ps1; Invoke-CVE202222965-SafeCheck -Url "https://$_" }
$Output | Where-Object {$_.url_content -match 'CVE_2022_22965 was sucessfully exploited' -or $_.base_content -match 'CVE_2022_22965 was sucessfully exploited'}
```

Suggestion: run the script twice against the target with a 2' difference between requests. 



## Get the content

```
git clone https://github.com/daniel0x00/Invoke-CVE-2022-22965-SafeCheck
cd Invoke-CVE-2022-22965-SafeCheck
```

{% embed url="https://github.com/daniel0x00/Invoke-CVE-2022-22965-SafeCheck" %}

<figure><img src="https://avatars.githubusercontent.com/u/6474092?v=4" alt=""><figcaption><p>daniel0x00</p></figcaption></figure>
