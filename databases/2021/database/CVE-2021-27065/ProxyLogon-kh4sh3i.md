# ProxyLogon

ProxyLogon (CVE-2021-26855+CVE-2021-27065) Exchange Server RCE (SSRF->GetWebShell)

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/kh4sh3i](https://github.com/kh4sh3i) |
| Url      | [https://github.com/kh4sh3i/ProxyLogon](https://github.com/kh4sh3i/ProxyLogon)                                               |
| Stars    | 3                                                          |
| License  | Creative Commons Zero v1.0 Universal                                                        |

<details>

<summary>Topic / Tags</summary>

* 0day* 2021-27065* cve* cve-2021-26855* exchange* exchange-server* exploit* microsoft* microsoft-exchange-proxylogon* outlook* proxylogon* zeroday

</details>

## Readme

# ProxyLogon
ProxyLogon is the formally generic name for CVE-2021-26855, a vulnerability on Microsoft Exchange Server that allows an attacker bypassing the authentication and impersonating as the admin. We have also chained this bug with another post-auth arbitrary-file-write vulnerability, CVE-2021-27065, to get code execution.


## ProxyLogon For Python3
```python
usage:
    sudo python3 proxylogon.py --host=target.com --mail=admin@target.com
    sudo python3 proxylogon.py --host=target.com --mails=./mails.txt
```


## ProxyLogon For Go
```go
usage:
    go run proxylogon.go -u target.com -e admin@target.com
```



#### Tips:
1) recon target to find valid email address
2) if you do not find any email, use bruteforce target with your email file.
3) in some target automation exploit not work, you should bruteforce SID and replace in SID=500

### manual pentest 
```python
sudo python2 /manual/check.py 
sudo python2 /manual/shell.py 
sudo python2 /manual/brute.py 
```

<img src="/img/1.png" width="800px" />
<img src="/img/2.png" width="800px" />
<img src="/img/3.png" width="800px" />
<img src="/img/4.png" width="800px" />
<img src="/img/5.png" width="800px" />


#### references
* [proxylogon](https://proxylogon.com/)



## Get the content

```
git clone https://github.com/kh4sh3i/ProxyLogon
cd ProxyLogon
```

{% embed url="https://github.com/kh4sh3i/ProxyLogon" %}

<figure><img src="https://avatars.githubusercontent.com/u/64693844?v=4" alt=""><figcaption><p>kh4sh3i</p></figcaption></figure>
