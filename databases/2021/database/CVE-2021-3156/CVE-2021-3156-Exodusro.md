# CVE-2021-3156

null

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/Exodusro](https://github.com/Exodusro) |
| Url      | [https://github.com/Exodusro/CVE-2021-3156](https://github.com/Exodusro/CVE-2021-3156)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2021-3156 PoC

## Introdução

Este é um exploit para o `CVE-2021-3156` vulnerabilidade no sudo (apelidada de [Baron Samedit](https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt) by Qualys).

## Modo de Uso

build:
```
$ make
```


lista de alvos:
```
$ ./sudo-hax-me-a-sandwich
```

run:
```
$ ./sudo-hax-me-a-sandwich <target_number>
```

modo manual:
```
$ ./sudo-hax-me-a-sandwich <smash_len_a> <smash_len_b> <null_stomp_len> <lc_all_len>
```

## Detecção de alvo de brute force (experimental)

Assegure-se de ter [GNU parallel](https://ftpmirror.gnu.org/parallel/parallel-latest.tar.bz2) instalado.

```
$ make brute
$ ./brute.sh <smash_start> <smash_end> <null_start> <null_end> <lc_start> <lc_end>
```

alguns padrões para tentar:
```
$ ./brute.sh 90 120 50 70 150 300
```

Irá consumir todos os núcleos disponíveis. Não tente fazer netflix & brute.

## Contribuindo
Contribua com o repositorio
Enviar PR (sensato), posso fundir.
Deixem um star

Algumas ideias:
* Mais alvos
* Localização de alvo
* Outras estratégias de exploração
* Funcionalidade mais independente:
    * Incorpore a biblioteca compartilhada hax.c (diminua, por favor, ELF golf + asm setuid / execve stub)
    * Adicione a lógica mkdir ao hax.c
* Limpeza de diretório / biblioteca compartilhada



## Get the content

```
git clone https://github.com/Exodusro/CVE-2021-3156
cd CVE-2021-3156
```

{% embed url="https://github.com/Exodusro/CVE-2021-3156" %}

<figure><img src="https://avatars.githubusercontent.com/u/27811489?v=4" alt=""><figcaption><p>Exodusro</p></figcaption></figure>
