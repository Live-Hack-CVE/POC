# cisco_asa_research

Cisco ASA Software and ASDM Security Research

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/jbaines-r7](https://github.com/jbaines-r7) |
| Url      | [https://github.com/jbaines-r7/cisco_asa_research](https://github.com/jbaines-r7/cisco_asa_research)                                               |
| Stars    | 69                                                          |
| License  | BSD 3-Clause "New" or "Revised" License                                                        |

<details>

<summary>Topic / Tags</summary>

* 0-day* asa* asdm* blackhat2022* cisco* cve-2021-1585* cve-2022-20828* cve-2022-20829* defcon30* exploit* metasploit-modules* yara

</details>

## Readme

# Cisco ASA Research

This repository contains slides and code presented at Black Hat USA 2022 and DEF CON 30. The following can be found:

* Slides
  * DEF CON 30 and Black Hat slide decks. The DEF CON deck is slightly longer due to a longer time slot.
* [theway](https://github.com/jbaines-r7/theway) - a tool for creating malicious/distributable ASDM packages for the Cisco ASA ([CVE-2022-20829](https://nvd.nist.gov/vuln/detail/CVE-2022-20829)).
* [whatsup](https://github.com/jbaines-r7/whatsup) - a tool for creating malicious/distributable Cisco FirePOWER module installation packages (No CVE).
* [pinchme](https://github.com/jbaines-r7/pinchme) - a tool for creating malicious/distributable Cisco FirePOWER boot images (No CVE).
* [slowcheetah](https://github.com/jbaines-r7/slowcheetah) - a tool for uploading FirePOWER module boot images to Cisco ASA-X and catching reverse shells.
* [staystaystay](https://github.com/jbaines-r7/staystaystay) - an exploit for [CVE-2021-1585](https://nvd.nist.gov/vuln/detail/CVE-2021-1585), an unath RCE vulnerability affecting Cisco ASDM.
* [asdm_version_scanner](https://github.com/jbaines-r7/asdm_version_scanner) - a tool for scanning ASA ASDM web interfaces and collecting versions. The repository contains results from an internet scan conducted on June 17, 2022.
* [getchoo](https://github.com/jbaines-r7/getchoo) - a tool for extracting the contents of an ASDM sgz file.
* `modules/` (Metasploit):
  * An RCE module for [CVE-2022-20828](https://nvd.nist.gov/vuln/detail/CVE-2022-20828): Remote ASDM -> FirePOWER root.
  * An RCE module for [CVE-2021-1585](https://nvd.nist.gov/vuln/detail/CVE-2021-1585): Unauthenticated RCE affecting ASDM *client*.
  * An RCE module that installs a Cisco FirePOWER boot image, roots it, and grabs a meterpreter root shell (No CVE).
  * A PackRat post-exploitation module to extract credentials from ASDM client log files ([CVE-2022-20651](https://nvd.nist.gov/vuln/detail/CVE-2022-20651))
  * An ASDM (HTTP) brute-force authentication module.
  * A module for dumping the ASA running-config over ASDM (HTTP).
* `yara/` contains [YARA](https://virustotal.github.io/yara/) rules to help identify malicious files or exploitation.
* `slides/` contains the slide decks presented at BH USA 2022 and DEF CON 30.



## Get the content

```
git clone https://github.com/jbaines-r7/cisco_asa_research
cd cisco_asa_research
```

{% embed url="https://github.com/jbaines-r7/cisco_asa_research" %}

<figure><img src="https://avatars.githubusercontent.com/u/91965877?v=4" alt=""><figcaption><p>jbaines-r7</p></figcaption></figure>
