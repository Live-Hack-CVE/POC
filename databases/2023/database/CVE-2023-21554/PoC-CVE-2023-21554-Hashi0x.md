# PoC-CVE-2023-21554

Windows Message Queuing vulnerability exploitation with custom payloads

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/Hashi0x](https://github.com/Hashi0x) |
| Url      | [https://github.com/Hashi0x/PoC-CVE-2023-21554](https://github.com/Hashi0x/PoC-CVE-2023-21554)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2023-21554
The only public functional exploitation module for the recently discovered MSMQ vulnerability.

## Requirements

Dependencies must be installe before this program is usable

``` apt install python3 pip3 || yum install python3 python3-pip```

``` apt install nmap || yum install epel-release nmap```

An nmap script is provided to identify potentailly vulnerable targets running on port 1801. You can use Shodan API to download a list of hosts running MSMQ or you can build your own list by running zmap on port 1801 then using the nmap script on hosts individually or in an automated manner.

## Syntax
![A3](https://user-images.githubusercontent.com/131184248/232833098-261dccc1-390f-4c8e-8813-d6c7d3108719.png)


``` python3 RCE.py -t HOST -p PORT (default 1801) -timeout SECONDS -P COMMAND```

Netcat is recommended for testing initially before testing other payloads. 
First a port scan is ran on the host using nmap to see if there is an application running on specified port followed by exploitation payload if returns positive. Session log is stored locally.

Payload can be stored within a file and used by specifying path when running the script.

![A1](https://user-images.githubusercontent.com/131184248/232833209-b2f84247-f214-400b-908a-1e6e773a6e64.png)

![A2](https://user-images.githubusercontent.com/131184248/232833247-3c6f5b15-cc0b-48ec-83ea-586f51af97b5.png)

## ATTENTION

Do not fall for scammers trying to impersonate or sell fake exploits, verify the authenticity of the files by matching hashes and emailing us.

``` ee83688d5a68b2434448ae42dee10eb379f6da4ea965696033d4ec835415bd7a  SHA256 rce.py```

``` d2b40705325ef66147329be2ca45c2033d56c0942f1c38d7c7a48470303e6f5a  SHA256 cve-2023-21554.nse```

[BUY FILES HERE](https://bit.ly/Queuejumper)



## Get the content

```
git clone https://github.com/Hashi0x/PoC-CVE-2023-21554
cd PoC-CVE-2023-21554
```

{% embed url="https://github.com/Hashi0x/PoC-CVE-2023-21554" %}

<figure><img src="https://avatars.githubusercontent.com/u/131184248?v=4" alt=""><figcaption><p>Hashi0x</p></figcaption></figure>
