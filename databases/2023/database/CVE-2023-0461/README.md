# CVE-2023-0461

There is a use-after-free vulnerability in the Linux Kernel which can be exploited to achieve local privilege escalation. To reach the vulnerability kernel configuration flag CONFIG_TLS or CONFIG_XFRM_ESPINTCP has to be configured, but the operation does not require any privilege.

There is a use-after-free bug of icsk_ulp_data of a struct inet_connection_sock.

When CONFIG_TLS is enabled, user can install a tls context (struct tls_context) on a connected tcp socket. The context is not cleared if this socket is disconnected and reused as a listener. If a new socket is created from the listener, the context is inherited and vulnerable.

The setsockopt TCP_ULP operation does not require any privilege.

We recommend upgrading past commit 2c02d41d71f90a5168391b6a5f2954112ba2307c

{% embed url="https://github.com/Live-Hack-CVE/full_database/blob/main/cves/2023/CVE-2023-0461.json" %}


* nidhi7598 ~> [linux-4.19.72_CVE-2023-0461](https://www.alice-snow.ru/2023/database/cve-2023-0461/linux-4.19.72_cve-2023-0461-nidhi7598)
* hshivhare67 ~> [kernel_v4.19.72_CVE-2023-0461](https://www.alice-snow.ru/2023/database/cve-2023-0461/kernel_v4.19.72_cve-2023-0461-hshivhare67)
* nidhi7598 ~> [linux-4.19.72_CVE-2023-0461](https://www.alice-snow.ru/2023/database/cve-2023-0461/linux-4.19.72_cve-2023-0461-nidhi7598)
* hheeyywweellccoommee ~> [linux-4.19.72_CVE-2023-0461-ycnbd](https://www.alice-snow.ru/2023/database/cve-2023-0461/linux-4.19.72_cve-2023-0461-ycnbd-hheeyywweellccoommee)
* hshivhare67 ~> [kernel_v4.19.72_CVE-2023-0461](https://www.alice-snow.ru/2023/database/cve-2023-0461/kernel_v4.19.72_cve-2023-0461-hshivhare67)