# check_struts

Apache Struts version analyzer (Ansible) based on CVE-2017-5638

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/andypitcher](https://github.com/andypitcher) |
| Url      | [https://github.com/andypitcher/check_struts](https://github.com/andypitcher/check_struts)                                               |
| Stars    | 1                                                          |
| License  | GNU General Public License v3.0                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# check_struts

This project has been created following 2017 [Equifax exploit]( https://thehackernews.com/2017/09/equifax-apache-struts.html)

The **check_struts.sh** script aims at retrieving any Apache struts libraries version and location found and/or loaded on the system.
It can be run directly on a server, or with the provided Ansible playbook, to handle several servers.


## Possible Outputs:

- *"Libs path and versions loaded on the system:"*  

   The libraries found are currently running on the system, and could be accessible.

- *"Libs path and versions installed on the system:"* 

   The librairies are present on the filesystem, but not running.
   
 ## Example with Ansible Playbook:
 
 ```
 ➜  ansible-playbook git:(master) ✗ ansible-playbook play.yml -i inventory

PLAY [Check Struts] ***********************************************************************************************************************************************************************************************

TASK [ensure a list of packages installed] ************************************************************************************************************************************************************************
ok: [servername]

TASK [Upload script check-struts.sh] ******************************************************************************************************************************************************************************
ok: [servername]

TASK [Check if struts presence/version] ***************************************************************************************************************************************************************************
ok: [servername]

TASK [debug] ******************************************************************************************************************************************************************************************************
skipping: [servername]

TASK [Remove check-struts.sh] *************************************************************************************************************************************************************************************
ok: [servername]

PLAY RECAP ********************************************************************************************************************************************************************************************************
servername                 : ok=4    changed=0    unreachable=0    failed=0   

```   

[Apache Struts full CVEs](https://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-6117/Apache-Struts.html)



## Get the content

```
git clone https://github.com/andypitcher/check_struts
cd check_struts
```

{% embed url="https://github.com/andypitcher/check_struts" %}

<figure><img src="https://avatars.githubusercontent.com/u/12878731?v=4" alt=""><figcaption><p>andypitcher</p></figcaption></figure>
