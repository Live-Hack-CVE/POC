# CVE-2021-4034_POC

Proof Of Concept for the 2021's pkexec vulnerability CVE-2021-4034

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/JoaoFukuda](https://github.com/JoaoFukuda) |
| Url      | [https://github.com/JoaoFukuda/CVE-2021-4034_POC](https://github.com/JoaoFukuda/CVE-2021-4034_POC)                                               |
| Stars    | 1                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2021-4034 - Proof Of Concept

This *POC* exploits *GLib*'s `g_printerr` to leverage code execution through the injection of the `GCONV_PATH` environmental variable.

## Running the exploit

Make a tarball file of the exploit:

```bash
make tar
```

Then somehow transfer the generated tar to the target machine, compile, and run the vulnerability:

```bash
make
./poc
```

The exploit will try to execute a `/bin/sh` as root.

## Further reading

* [The blog post this exploit was based on](https://milot.io/dissecting-pkexec-cve-2021-4034-vulnerability/)
* [An article to better understand the theory behind the attack](https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034)



## Get the content

```
git clone https://github.com/JoaoFukuda/CVE-2021-4034_POC
cd CVE-2021-4034_POC
```

{% embed url="https://github.com/JoaoFukuda/CVE-2021-4034_POC" %}

<figure><img src="https://avatars.githubusercontent.com/u/37672942?v=4" alt=""><figcaption><p>JoaoFukuda</p></figcaption></figure>
