# oxide_hive

Exploit for CVE-2021-36934

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/chron1k](https://github.com/chron1k) |
| Url      | [https://github.com/chron1k/oxide_hive](https://github.com/chron1k/oxide_hive)                                               |
| Stars    | 3                                                          |
| License  | MIT License                                                        |

<details>

<summary>Topic / Tags</summary>

* cve-2021-36934* cybersecurity* exploit* rust* security* windows

</details>

## Readme

# Oxide Hive
An exploit for the HiveNightmare/SeriousSAM vulnerability that allows you to read registry hives containing sensitive data without admin privileges. If that doesn't sound like privilege escalation I don't know what does.

# Usage
After building the exploit with `cargo build` and retrieving the binary, deploy it in your testing environment, open CMD and do `.\oxide_hive [max shadow copies]`, the default for shadow copies is 15. The hives SAM, SECURITY and SYSTEM should be dumped to the working directory

From then on you can use [this script](https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py) with the command `secretsdump.py -sam SAM.dump -security SECURITY.dump -system SYSTEM.dump local` to retrieve the NTLM hashes.
Then you can use [another script](https://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.py) with the command `psexec.py -hashes <account's hash> <user>@<machine's ip> cmd.exe` to remotely log into any account. Congrats, you just went from unprivileged user to NT Authority with only 3 commands.

# Credits
- @jonasLyk, the person who discovered the vulnerability
- @GossiTheDog, the creator of [the original exploit](https://github.com/GossiTheDog/HiveNightmare) which I took inspiration from



## Get the content

```
git clone https://github.com/chron1k/oxide_hive
cd oxide_hive
```

{% embed url="https://github.com/chron1k/oxide_hive" %}

<figure><img src="https://avatars.githubusercontent.com/u/88612701?v=4" alt=""><figcaption><p>chron1k</p></figcaption></figure>
