# Serious-Sam---CVE-2021-36934-Mitigation-for-Datto-RMM

This PowerShell script will take the mitigation measures for CVE-2021-36934 described by Microsoft and the US CERT team.  https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934 https://kb.cert.org/vuls/id/506989  USE AT YOUR OWN RISK -- BACKUPS MAY BREAK.

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/jmaddington](https://github.com/jmaddington) |
| Url      | [https://github.com/jmaddington/Serious-Sam---CVE-2021-36934-Mitigation-for-Datto-RMM](https://github.com/jmaddington/Serious-Sam---CVE-2021-36934-Mitigation-for-Datto-RMM)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# Overview #

This is a Datto RMM component to mitigate CVE-2021-36934, aka Serious SAM.

It follows the mitigation measures outlined at:
 * https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36934
 * https://kb.cert.org/vuls/id/506989

USE AT YOUR OWN RISK. EXPECT THIS TO BREAK SOME BACKUPS TEMPORARILY.

Only basic error checking is in place.

# Usage #
Just upload the component into Datto RMM and run it. It will prompt you for a UDF to set that will either be set to
"Mitigated" or "UN-mitigated" allowing you to filter machines based on the mitigation. This is because current (reliable & easy)
tests for the vulnerability require UN-privileged access to run, not an easy task with Datto RMM.

If you use another RMM review the code comments, the script will still work but you may need to swap
out some vendor specific items.

# Improvements / Contributions #
Fork the repo and then submit a pull request.


## Get the content

```
git clone https://github.com/jmaddington/Serious-Sam---CVE-2021-36934-Mitigation-for-Datto-RMM
cd Serious-Sam---CVE-2021-36934-Mitigation-for-Datto-RMM
```

{% embed url="https://github.com/jmaddington/Serious-Sam---CVE-2021-36934-Mitigation-for-Datto-RMM" %}

<figure><img src="https://avatars.githubusercontent.com/u/2353597?v=4" alt=""><figcaption><p>jmaddington</p></figcaption></figure>
