# cve-hash-harvester

Finds an identifiable hash value for each version of GitLab vulnerable to a specific CVE by the related semantic reversion range (example: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22205.json) for use in passive fingerprinting.

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/GitLab-Red-Team](https://github.com/GitLab-Red-Team) |
| Url      | [https://github.com/GitLab-Red-Team/cve-hash-harvester](https://github.com/GitLab-Red-Team/cve-hash-harvester)                                               |
| Stars    | 1                                                          |
| License  | Other                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# cve-hash-generator

Finds an identifiable hash value for each version of GitLab vulnerable to a specific CVE by the defined semantic version range. Example: https://gitlab.com/gitlab-org/cves/-/blob/9e9a08f61709c8016039468c90e1880715d173e7/2021/CVE-2021-22205.json#L19-29.

#### Running The Tool

###### Prerequisites

This tool requires that [docker be installed](https://docs.docker.com/get-docker/) along with [docker-compose](https://docs.docker.com/compose/install/) on the machine executing the binary.  A paid license for docker is recommended due to the number of image downloads necessary in some cases.  This tool requires connection to a mongodb instance of your choice.  A docker-compose.yml file exists for convenience.

#### Usage

* Clone the repository.
* Type `make build`.  The process may take a couple of minutes.
* Change the password in the docker-compose.yml file in the root of the repository.  There are three occurances of the password, which need to match.
* Change directories with `cd ./bin`.
* Edit the `.env` file in the `./bin` directory to set the environment variable "MONGODB_URI" to an appropriate connection string.  Example:  `MONGODB_URI="mongodb://root:<MY_SECURE_PASSWORD>@localhost:27017/"`.  <MY_SECURE_PASSWORD> should match the password you used in the docker-compose.yml file.
* Run: `docker-compose up -d` to launch the mongodb instance and mongo express viewer.  NOTE: this app requires a mongodb instance, whether in docker or elsewhere.
* Launch the mongo express viewer if you like at:  http://localhost:8081/
* Run the tool with `./cve-hash-harvester --mongoCollection <CVE_ID> --vulnerableConstraints <semver_range1> --vulnerableConstraints <semver_range2> ...`
* Example to generate hashes for [CVE-2021-22205](https://gitlab.com/gitlab-org/cves/-/blob/6e3d7d80af543977f9b99870657f75fc50a7b3a8/2021/CVE-2021-22205.json#L19-29):  `./cve-hash-harvester -m CVE-2021-22205 -v ">=11.9, <13.8.8" -v ">=13.9, <13.9.6" -v ">=13.10, <13.10.3"`

#### Contributing

This project uses [AngularJS commit message formatting](https://github.com/angular/angular/blob/master/CONTRIBUTING.md#-commit-message-format) to support automatic semantic versioning releases using [semantic-release](https://github.com/semantic-release/semantic-release).  For an MR to be accepted, each commit message must follow this format.

* Clone the project.  Run `git checkout -b <my-awesome-updates>`.
* Run `make .init` to initialize the local dev environment
* Run `make .test` to run the tests
* Run `make build` to produce binaries
* Commit your changes using the commit message formatting mentioned above.


## Get the content

```
git clone https://github.com/GitLab-Red-Team/cve-hash-harvester
cd cve-hash-harvester
```

{% embed url="https://github.com/GitLab-Red-Team/cve-hash-harvester" %}

<figure><img src="https://avatars.githubusercontent.com/u/97901232?v=4" alt=""><figcaption><p>GitLab-Red-Team</p></figcaption></figure>
