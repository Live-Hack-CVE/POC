# CVE-2022-0847_DirtyPipeExploit

A “Dirty Pipe” vulnerability with CVE-2022-0847 and a CVSS score of 7.8 has been identified, affecting Linux Kernel 5.8 and higher. The vulnerability allows attackers to overwrite data in read-only files. Threat actors can exploit this vulnerability to privilege themselves with code injection.

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/dadhee](https://github.com/dadhee) |
| Url      | [https://github.com/dadhee/CVE-2022-0847_DirtyPipeExploit](https://github.com/dadhee/CVE-2022-0847_DirtyPipeExploit)                                               |
| Stars    | 3                                                          |
| License  | GNU General Public License v2.0                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# What is this

This is Max Kellermann's proof of concept for Dirty Pipe, but modified to overwrite root's password field in /etc/passwd and restore after popping a root shell.

**Side Note:** I do not claim any credit for finding this vulnerability or writing the proof of concept. This exploit is merely a small modification of Kellermann's proof of concept to enable quick/easy exploitation. Please read the original article on this extremely interesting vulnerability @ https://dirtypipe.cm4all.com/ when you get the opportunity. It really does deserve your time to understand it.

# How to use this

1. Compile with `./compile.sh` (assumes `gcc` is installed)
2. Run `./exploit` and it'll pop a root shell

# su: must be run from a terminal

If you get this error message:
1. Login as `root` with the password `aaron`.
2. Then, restore `/etc/passwd` by running `mv /tmp/passwd.bak /etc/passwd`

(oops sorry my laptop battery is dying and my charger broke so I don't have time to fix this the right now, sorry)




## Get the content

```
git clone https://github.com/dadhee/CVE-2022-0847_DirtyPipeExploit
cd CVE-2022-0847_DirtyPipeExploit
```

{% embed url="https://github.com/dadhee/CVE-2022-0847_DirtyPipeExploit" %}

<figure><img src="https://avatars.githubusercontent.com/u/37909237?v=4" alt=""><figcaption><p>dadhee</p></figcaption></figure>
