# CVE-2022-26809

not an exploit or a poc

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/killvxk](https://github.com/killvxk) |
| Url      | [https://github.com/killvxk/CVE-2022-26809](https://github.com/killvxk/CVE-2022-26809)                                               |
| Stars    | 18                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

# CVE-2022-26809
this is not an exploit or a poc


For someone familiar with RPC using bindiff is enough to make an exploit

Constructing a poc is not complicated

And it is not complicated to construct the exploit from the poc

## CVE-2022-26809 has nothing to do with SMB, it's an RPC vuln where a variety of transports can be used, like TCP/135, SMB/445, etc.

# so do the patch now！！

# some src part 1
```c++
/*++
Function Name:GetCoalescedBuffer
Parameters:
    Message - the message structure that will receive the params
Description:
    This routine will coalesce the buffers in the buffer queue into a single
    buffer and return it in the Message structure. If the RPC_BUFFER_EXTRA
    flag is set, the data is appended to the existing buffer in Message->Buffer.
Returns:
    RPC_S_OK - the function was successful in doing its job
    RPC_S_OUT_OF_MEMORY - ran out of memory.
--*/
RPC_STATUS
OSF_SCALL::GetCoalescedBuffer (
    IN PRPC_MESSAGE Message,
    BOOL fForceExtra
    );
/*++
Function Name:ProcessResponse
Parameters:
Description:
    Process the response data. The first buffer is placed on the buffer queue
    only after alloc_hint bytes have been received.
Returns:
--*/
RPC_STATUS
OSF_CCALL::ProcessResponse (
    IN rpcconn_response *Packet,
    IN PRPC_MESSAGE Message,
    OUT BOOL *pfSubmitReceive
    );
```


# to be continued



## Get the content

```
git clone https://github.com/killvxk/CVE-2022-26809
cd CVE-2022-26809
```

{% embed url="https://github.com/killvxk/CVE-2022-26809" %}

<figure><img src="https://avatars.githubusercontent.com/u/309424?v=4" alt=""><figcaption><p>killvxk</p></figcaption></figure>
