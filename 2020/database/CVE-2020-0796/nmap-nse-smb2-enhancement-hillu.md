# nmap-nse-smb2-enhancement

Enhancements for NMAP Script Engine SMB2/3 support

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/hillu](https://github.com/hillu) |
| Url      | [https://github.com/hillu/nmap-nse-smb2-enhancement](https://github.com/hillu/nmap-nse-smb2-enhancement)                                               |
| Stars    | 1                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>

* cve-2020-0796* detection* nmap* nse* smb2* smb3

</details>

## Readme

# Enhancements for SMB2 support in NMAP Script Engine

## Why

The smb2 implementation that is part of NMAP lacks support for parsing
`NEGOTIATE_CONTEXT` structures that can be used to determine hosts
that might be vulnerable to CVE-2020-0796. The code in this repository
adds that functionality.

## Usage

The modified `smb2.lua` library and the modified
`smb2-capabilities.nse` sript are intended to be used with NMAP 7.70.

Copy or symlink `smb2.lua` to `~/.nmap/nselib/` and use the NSE script
on a host:

    nmap --script=`pwd`/smb2-capabilities.nse $IP

## Author

Hilko Bengen <<bengen@hilluzination.de>>



## Get the content

```
git clone https://github.com/hillu/nmap-nse-smb2-enhancement
cd nmap-nse-smb2-enhancement
```

{% embed url="https://github.com/hillu/nmap-nse-smb2-enhancement" %}

<figure><img src="https://avatars.githubusercontent.com/u/173211?v=4" alt=""><figcaption><p>hillu</p></figcaption></figure>
